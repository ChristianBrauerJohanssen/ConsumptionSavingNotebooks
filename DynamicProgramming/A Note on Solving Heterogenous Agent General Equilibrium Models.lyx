#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
%\usepackage[pagebackref=false]{hyperref}
\hypersetup{colorlinks=true,citecolor=blue}
\hypersetup{colorlinks=true,linkcolor=blue}
\hypersetup{colorlinks=true,urlcolor=blue}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "palatino" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing onehalf
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\topmargin 3cm
\rightmargin 3cm
\bottommargin 3cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
A Note on Solving Heterogenous Agent General Equilibrium Models
\end_layout

\begin_layout Author
Jeppe Druedahl
\begin_inset Foot
status open

\begin_layout Plain Layout

\size scriptsize
CEBI, Department of Economics, University of Copenhagen, Øster Farimagsgade
 5, Building 26, DK-1353 Copenhagen K, Denmark.
 E-mail: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{jeppe.druedahl@econ.ku.dk}
\end_layout

\end_inset

.
 Website: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://econ.ku.dk/druedahl}
\end_layout

\end_inset

.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Christoffer Jessen Weissert
\begin_inset Foot
status open

\begin_layout Plain Layout

\size scriptsize
Department of Economics, University of Copenhagen, Øster Farimagsgade 5,
 Building 26, DK-1353 Copenhagen K, Denmark.
 E-mail: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{cjw@econ.ku.dk}
\end_layout

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Abstract
This note provides a brief introduction to equilibrium concepts and solution
 methods for heterogenous agent general equilibrium models.
\end_layout

\begin_layout Abstract

\series bold
Code:
\series default
 
\begin_inset CommandInset href
LatexCommand href
name "github.com/NumEconCopenhagen/ConsumptionSavingNotebooks/"
target "https://github.com/NumEconCopenhagen/ConsumptionSavingNotebooks/tree/master/DynamicProgramming#mini-course-in-dynamic-programming"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\begin_layout Plain Layout


\backslash
addtocounter{page}{-1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Overview
\begin_inset CommandInset label
LatexCommand label
name "sec:Overview"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Overview"
plural "false"
caps "false"
noprefix "false"

\end_inset

:
\series default
 This section provides an overview of the note and the literature.
\end_layout

\begin_layout Enumerate

\series bold
Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Equilibrium-concepts"
plural "false"
caps "false"
noprefix "false"

\end_inset

:
\series default
 This section introduces the model, which will be used as an example throughout
 this note, and the three fundamental equilibrium concepts:
\end_layout

\begin_deeper
\begin_layout Enumerate
Stationary equilibrium
\end_layout

\begin_layout Enumerate
Transition path
\end_layout

\begin_layout Enumerate
Dynamic equilibrium
\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Sequence-Space-Method"
plural "false"
caps "false"
noprefix "false"

\end_inset

:
\series default
 This section explains how to use the sequence-space method proposed in
 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_using_2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Heterogenous Agent (HA) models
\end_layout

\begin_layout Enumerate

\series bold
Stationary equilibrium:
\series default

\begin_inset Newline newline
\end_inset


\emph on
Deterministic steady state and transition path
\emph default

\begin_inset Newline newline
\end_inset


\series bold
Foundational papers:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "bewley_stationary_1986"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "imrohoroglu_cost_1989"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "huggett_risk-free_1993"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "aiyagari_uninsured_1994"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "carroll_requiem_2000"
literal "false"

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard

\series bold
A few policy examples: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "aiyagari_optimum_1998"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "conesa_taxing_2009"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "heathcote_consumption_2014"
literal "false"

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Dynamic/recursive/sequential equilibrium: 
\series default

\begin_inset Newline newline
\end_inset


\emph on
Aggregate shocks and stochastic dynamics
\emph default

\begin_inset Newline newline
\end_inset


\series bold
Foundational papers:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "krusell_incoem_1997,krusell_income_1998"
literal "false"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Reviews: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "heathcote_quantitative_2009"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "krusell_quantitative_2006"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "krueger_chapter_2016"
literal "false"

\end_inset


\end_layout

\begin_layout Subsection
Heterogenous Agent New Keynesian (HANK) models
\end_layout

\begin_layout Enumerate

\series bold
Frontier: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "kaplan_monetary_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "bayer_precautionary_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "luetticke_transmission_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "alves_further_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "hagedorn_fiscal_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_micro_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "bayer_shocks_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "fernandez-villaverde_financial_2020"
literal "false"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Analytical:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "bilbiie_limited_2008,bilbiie_monetary_2019,bilbiie_new_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "werning_incomplete_2015"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "challe_precautionary_2017"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "acharya_understanding_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "bilbiie_capital_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "debortoli_monetary_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_intertemporal_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "broer_new_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "ravn_macroeconomic_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_inequality_2020"
literal "false"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Others: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "oh_targeted_2012"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "gornemann_doves_2016"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "mckay_role_2016"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "mckay_power_2016"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "guerrieri_credit_2017"
literal "false"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand citet
key "den_haan_unemployment_2017"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "ravn_job_2017"
literal "false"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Empirical: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "cloyne_monetary_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "slacalek_household_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "holm_transmission_2020"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "wolf_missing_2020"
literal "false"

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Reviews:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "kaplan_microeconomic_2018"
literal "false"

\end_inset


\end_layout

\begin_layout Subsection
Computational methods
\end_layout

\begin_layout Itemize

\series bold
Early reviews: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "den_haan_computational_2010"
literal "false"

\end_inset

,
\begin_inset CommandInset citation
LatexCommand citet
key "schmedders_handbook_2013"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Continuous time:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "achdou_income_2020"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://benjaminmoll.com/codes/"
literal "false"

\end_inset

)
\end_layout

\begin_layout Itemize

\series bold
Full local solution: 
\series default

\begin_inset CommandInset citation
LatexCommand citet
key "winberry_method_2018"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Local aggregate solution:
\end_layout

\begin_deeper
\begin_layout Enumerate
State space: 
\begin_inset CommandInset citation
LatexCommand citet
key "bayer_solving_2019"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "MATLAB"
target "https://www.dropbox.com/sh/92ine0oj00ot9og/AAA6FKAkIASGSYsYY4vLjNvWa?dl=0"
literal "false"

\end_inset

, 
\begin_inset CommandInset href
LatexCommand href
name "Python"
target "https://github.com/econ-ark/HARK/tree/master/examples/BayerLuetticke"
literal "false"

\end_inset

)
\begin_inset Newline newline
\end_inset

Continuous time: 
\begin_inset CommandInset citation
LatexCommand citet
key "ahn_when_2018"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://github.com/gregkaplan/phact"
literal "false"

\end_inset

)
\end_layout

\begin_layout Enumerate
Sequence space: 
\begin_inset CommandInset citation
LatexCommand citet
key "boppart_exploiting_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_micro_2020"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://github.com/shade-econ/sequence-jacobian/#sequence-space-jacobian"
literal "false"

\end_inset

)
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Global aggregate solution:
\series default
 
\begin_inset CommandInset citation
LatexCommand citet
key "kubler_self-justied_2018"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "azinovic_deep_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "scheidegger_machine_2019"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "prohl_approximating_2019"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://github.com/zschorli/Proehl_SolvingHeterogAgentModels"
literal "false"

\end_inset

), 
\begin_inset CommandInset citation
LatexCommand citet
key "maliar_will_2019"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://notes.quantecon.org/submission/5ddb3c926bad3800109084bf"
literal "false"

\end_inset

, 
\begin_inset CommandInset href
LatexCommand href
name "video"
target "https://econ.columbia.edu/event/per-mini-course-serguei-maliar-associate-professor-in-economics-stanford-university/"
literal "false"

\end_inset

), 
\begin_inset CommandInset citation
LatexCommand citet
key "fernandez-villaverde_financial_2020"
literal "false"

\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "code"
target "https://github.com/jesusfv/financial-frictions"
literal "false"

\end_inset

)
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Equilibrium concepts
\begin_inset CommandInset label
LatexCommand label
name "sec:Equilibrium-concepts"

\end_inset


\end_layout

\begin_layout Standard
Throughout this note, we consider a simple one-asset economy without nominal
 frictions.
\end_layout

\begin_layout Enumerate

\series bold
Households:
\series default
 Continuum of measure 
\begin_inset Formula $1$
\end_inset

 who
\end_layout

\begin_deeper
\begin_layout Enumerate
Own stocks, 
\begin_inset Formula $a_{t-1}$
\end_inset


\end_layout

\begin_layout Enumerate
Supply labor with productivity 
\begin_inset Formula $e_{t}$
\end_inset

 
\begin_inset Newline newline
\end_inset

(exogenous and stochastic, mean one)
\end_layout

\begin_layout Enumerate
Consume, 
\begin_inset Formula $c_{t}$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Firms: 
\series default
Rent capital and hire labor to produce
\end_layout

\begin_layout Enumerate

\series bold
Capital:
\series default
 Depreciates with rate 
\begin_inset Formula $\delta$
\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Prices
\series default
 are taken as given by households and firms
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $r_{t}^{k}$
\end_inset

, rental rate
\end_layout

\begin_layout Enumerate
\begin_inset Formula $r_{t}=r_{t}^{k}-\delta$
\end_inset

,
\series bold
 
\series default
interest rate
\end_layout

\begin_layout Enumerate
\begin_inset Formula $w_{t}$
\end_inset

, wage rate
\end_layout

\end_deeper
\begin_layout Standard
We consider 
\series bold
two versions of the model
\series default
, where the 
\series bold
technology level
\series default
, 
\begin_inset Formula $Z_{t}$
\end_inset

, is either:
\end_layout

\begin_layout Enumerate

\series bold
Deterministic - 
\series default
no aggregate uncertainty
\end_layout

\begin_layout Enumerate

\series bold
Stochastic
\series default
 - aggregate uncertainty
\end_layout

\begin_layout Subsection
Firms
\end_layout

\begin_layout Itemize

\series bold
Production function:
\series default
 
\begin_inset Formula $Y_{t}=Z_{t}K_{t-1}^{\alpha}L_{t}^{1-\alpha}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Define
\series default
 
\begin_inset Formula $k_{t-1}\equiv K_{t-1}/L_{t}$
\end_inset


\end_layout

\begin_layout Itemize
Standard 
\series bold
pricing equations:
\begin_inset Formula 
\begin{align*}
r_{t}^{k} & =\alpha Z_{t}k_{t-1}^{\alpha-1}\\
w_{t} & =(1-\alpha)Z_{t}k_{t-1}^{\alpha}
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
Useful 
\series bold
implications:
\begin_inset Formula 
\begin{align*}
k_{t-1} & =\left(\frac{r_{t}+\delta}{\alpha Z_{t}}\right)^{\frac{1}{\alpha-1}}\equiv k(r_{t},Z_{t})\\
r_{t} & =\alpha Z_{t}k_{t-1}^{\alpha-1}\equiv r(k_{t-1},Z_{t})\\
w_{t} & =(1-\alpha)Z_{t}\left(\frac{r_{t}+\delta}{\alpha Z_{t}}\right)^{\frac{\alpha}{\alpha-1}}\equiv w(r_{t},Z_{t})
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Households - no aggregate uncertainty
\end_layout

\begin_layout Itemize

\series bold
Perfect foresight: 
\series default
Price sequence known, 
\begin_inset Formula $\{r_{t},w_{t}\}_{t\geq0}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Households solve:
\series default

\begin_inset Formula 
\begin{eqnarray*}
v_{t}(e{}_{t},a_{t-1}) & = & \max_{c_{t}}\frac{c_{t}^{1-\sigma}}{1-\sigma}+\beta\mathbb{E}_{t}\left[v_{t+1}(e_{t+1},a_{t})\right]\\
 & \text{s.t.}\\
a_{t}+c_{t} & = & (1+r_{t})a_{t-1}+w_{t}e_{t}\\
a_{t} & \geq & 0
\end{eqnarray*}

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Optimal saving:
\series default
 
\begin_inset Formula $a^{\ast}(e_{t},a_{t-1})$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Optimal consumption: 
\series default

\begin_inset Formula $c^{\ast}(e_{t},a_{t-1})$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Distribution: 
\begin_inset Formula $D_{t}$
\end_inset

 
\series default
over 
\begin_inset Formula $e_{t}$
\end_inset

 and 
\begin_inset Formula $a_{t-1}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Supply of capital: 
\begin_inset Formula $\mathcal{K}_{t}=\int a_{t}^{\ast}(e_{t},a_{t-1})dD_{t}$
\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Market clearing
\end_layout

\begin_layout Standard

\series bold
Market clearing
\series default
 requires
\begin_inset Formula 
\begin{align*}
\text{Capital: }K_{t} & =\mathcal{K}_{t}=\int a_{t}^{\ast}(e_{t},a_{t-1})dD_{t}\\
\text{Labour: }L_{t} & =\int e_{t}dD_{t}=1\\
\text{Goods: }Y_{t} & =\int c^{\ast}(e_{t},a_{t-1})dD_{t}+\delta K_{t-1}
\end{align*}

\end_inset

The 
\series bold
labor market clears trivially
\series default
, while we can leave out the 
\series bold
goods market
\series default
 due to 
\series bold
Walras's Law
\series default
.
\end_layout

\begin_layout Subsection
Solve household problem with EGM
\end_layout

\begin_layout Itemize

\series bold
Grids:
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $e_{t}\in\{e^{1},e^{2},\dots,e^{\#_{e}}\}$
\end_inset

 (discretized using 
\begin_inset CommandInset citation
LatexCommand citet
key "tauchen_quadrature-based_1991"
literal "true"

\end_inset

)
\end_layout

\begin_layout Enumerate
\begin_inset Formula $a_{t}\in\{a^{1},a^{2},\dots,a^{\#_{a}}\}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Guess:
\series default
 
\begin_inset Formula $v_{a,t+1}(e^{i},a^{j}),\,\forall i,j$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Time iteration:
\end_layout

\begin_deeper
\begin_layout Enumerate
Calculate: 
\begin_inset Formula $q_{t}(e^{i},a^{j})=\sum_{k=1}^{\#_{e}}\text{Pr}[e^{k}|e^{i}]v_{a,t+1}(e^{i},a^{j})$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $\tilde{c}^{ij}=q_{t}(e^{i},a^{j})^{-\sigma}$
\end_inset

 and 
\begin_inset Formula $\tilde{m}^{ij}=\tilde{c}^{ij}+a^{j}$
\end_inset


\end_layout

\begin_layout Enumerate
Interpolate 
\begin_inset Formula $\{\tilde{m}^{ij},a^{j}\}_{j=1}^{\#_{a}}$
\end_inset

 at 
\begin_inset Formula $m^{j}=(1+r_{t})a^{j}+w_{t}e^{i}$
\end_inset

 to find 
\begin_inset Formula $a^{\ast}(e^{i},a^{j})$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $c^{\ast}(e^{i},a^{j})=m_{t}-a^{\ast}(e^{i},a^{j})$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $v_{a,t+1}(e^{i},a^{j})=(1+r)c^{\ast}(e^{i},a^{j})^{-\sigma}$
\end_inset

 
\begin_inset Newline newline
\end_inset

(use of the envelope theorem)
\end_layout

\end_deeper
\begin_layout Standard

\series bold
Note: 
\series default
Any other 
\emph on
solution
\emph default
 method could have been used.
\end_layout

\begin_layout Subsection
Simulate household behavior on grid
\end_layout

\begin_layout Itemize

\series bold
Initial distribution:
\series default
 
\begin_inset Formula $D_{0}(e^{i},a^{j})=\frac{\text{Pr}[e^{i}]}{\#_{a}}$
\end_inset

 (
\emph on
ergodic
\emph default
 in 
\begin_inset Formula $e$
\end_inset

, 
\emph on
uniform
\emph default
 in 
\begin_inset Formula $a$
\end_inset

)
\end_layout

\begin_layout Itemize

\series bold
Update:
\series default

\begin_inset Formula 
\begin{align*}
D_{t+1}(e^{k},a^{l})= & \sum_{i=1}^{\#_{e}}\text{Pr}[e^{k}|e^{i}]\sum_{j=1}^{\#_{a}}D_{t}(e^{i},a^{j})\omega(a^{\star}(e^{i},a^{j}),a^{\max\{l-1,1\}},a^{l},a^{\min\{l+1,\#_{a}\}})
\end{align*}

\end_inset

where
\begin_inset Formula 
\begin{align*}
\omega(a,\underline{a},\tilde{a},\overline{a}) & =1\{a\in[\underline{a},\overline{a}]\}\begin{cases}
\frac{\overline{a}-a}{\overline{a}-\tilde{a}} & \text{if }a\geq\tilde{a}\\
\frac{a-\underline{a}}{\overline{\tilde{a}}-\underline{a}} & \text{if }a<\tilde{a}
\end{cases}
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Note I: 
\series default
If only on grid choices where possible then
\begin_inset Formula 
\[
D_{t+1}(e^{k},a^{l})=\sum_{i=1}^{\#_{e}}\text{Pr}[e^{k}|e^{i}]\sum_{j=1}^{\#_{a}}D_{t}(e^{i},a^{j})1\{a^{\star}(e^{i},a^{j})=a^{l}\}
\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Note II: 
\series default

\begin_inset Formula $\omega$
\end_inset

 is a weight on each grid point calculated using linear interpolation
\series bold

\begin_inset Formula 
\begin{align*}
\omega(\underline{a},\underline{a},\tilde{a},\overline{a}) & =\omega(\overline{a},\underline{a},\tilde{a},\overline{a})=1\\
\omega(\tilde{a},\underline{a},\tilde{a},\overline{a}) & =1
\end{align*}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Note: 
\series default
Any other 
\emph on
simulation
\emph default
 method could have been used.
\end_layout

\begin_layout Subsection
Definition: Stationary equilibrium
\end_layout

\begin_layout Standard
A 
\series bold
stationary equilibrium
\series default
 for a given 
\begin_inset Formula $Z_{ss}$
\end_inset

 is one where
\end_layout

\begin_layout Enumerate
Quantities 
\begin_inset Formula $K_{ss}$
\end_inset

 and 
\begin_inset Formula $L_{ss},$
\end_inset

 
\end_layout

\begin_layout Enumerate
prices 
\begin_inset Formula $r_{ss}$
\end_inset

 and 
\begin_inset Formula $w_{ss},$
\end_inset


\end_layout

\begin_layout Enumerate
a distribution 
\begin_inset Formula $D_{ss}$
\end_inset

 over 
\begin_inset Formula $e_{t}$
\end_inset

 and 
\begin_inset Formula $a_{t-1}$
\end_inset


\end_layout

\begin_layout Enumerate
and policy functions 
\begin_inset Formula $a_{ss}^{\ast}(e_{t},a_{t-1})$
\end_inset

 and 
\begin_inset Formula $c_{ss}^{\ast}(e_{t},a_{t-1})$
\end_inset


\end_layout

\begin_layout Standard
are such that
\end_layout

\begin_layout Enumerate
\begin_inset Formula $a_{ss}^{\ast}(\bullet)$
\end_inset

 and 
\begin_inset Formula $c_{ss}^{\ast}(\bullet)$
\end_inset

 solves the household problem
\end_layout

\begin_layout Enumerate
\begin_inset Formula $D_{ss}$
\end_inset

 is the invariant distribution implied by the household problem
\end_layout

\begin_layout Enumerate
Firms maximize profits, 
\begin_inset Formula $r_{ss}=r(K_{ss}/L_{ss},Z_{ss})$
\end_inset

 and 
\begin_inset Formula $w_{ss}=w(r_{ss},Z_{ss})$
\end_inset


\end_layout

\begin_layout Enumerate
The labor market clears, i.e.
 
\begin_inset Formula $L_{ss}=\int e_{t}dD_{ss}=1$
\end_inset


\end_layout

\begin_layout Enumerate
The capital market clears, i.e.
 
\begin_inset Formula $K_{ss}=\int a_{ss}^{\ast}(e_{t},a_{t-1})dD_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate
The goods market clears, i.e.
 
\begin_inset Formula $Y_{ss}=\int c_{ss}^{\ast}(e_{t},a_{t-1})dD_{ss}+\delta K_{ss}$
\end_inset


\end_layout

\begin_layout Subsection
Find stationary equilibrium
\end_layout

\begin_layout Enumerate
Guess on 
\begin_inset Formula $r_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $w_{ss}=w(r_{ss},Z_{ss})$
\end_inset


\end_layout

\begin_layout Enumerate
Solve the infinite horizon household problem
\end_layout

\begin_layout Enumerate
Simulate until convergence of 
\begin_inset Formula $D_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate supply 
\begin_inset Formula $\mathcal{K}_{ss}=\int a_{ss}^{\ast}(e_{t},a_{t-1})dD_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate demand 
\begin_inset Formula $K_{ss}=k(r_{ss},Z_{ss})L_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate
If for some tolerance 
\begin_inset Formula $\epsilon$
\end_inset


\begin_inset Formula 
\[
\left|\mathcal{K}_{ss}-K_{ss}\right|<\epsilon
\]

\end_inset

then stop, otherwise update 
\begin_inset Formula $r_{ss}$
\end_inset

 appropriately and return to step 2
\end_layout

\begin_layout Standard
This is just a 
\series bold
root-finding problem
\end_layout

\begin_layout Subsection
Definition: Transition path
\end_layout

\begin_layout Standard
A 
\series bold
transition path
\series default
 for 
\begin_inset Formula $t\in\{0,1,2,\dots\}$
\end_inset

, given an initial distribution 
\begin_inset Formula $D_{0}$
\end_inset

 and a path of 
\begin_inset Formula $Z_{t}$
\end_inset

, is paths of quantities 
\begin_inset Formula $K_{t}$
\end_inset

 and 
\begin_inset Formula $L_{t}$
\end_inset

, prices 
\begin_inset Formula $r_{t}$
\end_inset

 and 
\begin_inset Formula $w_{t}$
\end_inset

, policy functions 
\begin_inset Formula $a_{t}^{\ast}(\bullet)$
\end_inset

 and 
\begin_inset Formula $c_{t}^{\ast}(\bullet)$
\end_inset

, distributions 
\begin_inset Formula $D_{t}$
\end_inset

, such that for all 
\begin_inset Formula $t$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $a_{t}^{\ast}(\bullet)$
\end_inset

 and 
\begin_inset Formula $c_{t}^{\ast}(\bullet)$
\end_inset

 solve the household problem given price paths
\end_layout

\begin_layout Enumerate
\begin_inset Formula $D_{t}$
\end_inset

 are implied by the household problem given price paths and 
\begin_inset Formula $D_{0}$
\end_inset


\end_layout

\begin_layout Enumerate
Firms maximizes profit, 
\begin_inset Formula $r_{t}=r(K_{t-1}/L_{t},Z_{t})$
\end_inset

 and 
\begin_inset Formula $w_{t}=w(r_{t},Z_{t})$
\end_inset


\end_layout

\begin_layout Enumerate
The labor market clears, i.e.
 
\begin_inset Formula $L_{t}=\int e_{t}dD_{t}=1$
\end_inset


\end_layout

\begin_layout Enumerate
The capital market clears, i.e.
 
\begin_inset Formula $K_{t}=\int a_{t}^{\ast}(\bullet)dD_{t}$
\end_inset


\end_layout

\begin_layout Enumerate
The goods market clears, i.e.
 
\begin_inset Formula $Y_{t}=\int c_{t}^{\ast}(\bullet)dD_{t}+\delta K_{t-1}$
\end_inset


\end_layout

\begin_layout Subsection
Find transition path
\end_layout

\begin_layout Enumerate
Choose truncation horizon 
\begin_inset Formula $\mathcal{T}$
\end_inset


\end_layout

\begin_layout Enumerate
Guess on 
\begin_inset Formula $\{r_{t}\}_{t=0}^{\mathcal{T}}=\{r_{ss}\}_{t=0}^{\mathcal{T}}$
\end_inset

 (or something else)
\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $\{w_{t}\}_{t=0}^{\mathcal{T}}=\{w(r_{ss},Z_{t})\}_{t=0}^{\mathcal{T}}$
\end_inset


\end_layout

\begin_layout Enumerate
Solve the household problem backwards along the transition path
\end_layout

\begin_layout Enumerate
Simulate households forward along the transition path
\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $\{k_{t}\}_{t=0}^{\mathcal{T}}=\{\int a_{t}^{\ast}(\bullet)dD_{t}\}_{t=0}^{\mathcal{T}}$
\end_inset


\end_layout

\begin_layout Enumerate
Calculate 
\begin_inset Formula $\{r_{t}^{\prime}\}_{t=0}^{\mathcal{T}}=\{r(k_{t-1},Z_{t})\}_{t=0}^{\mathcal{T}}$
\end_inset


\end_layout

\begin_layout Enumerate
Stop if for some tolerance 
\begin_inset Formula $\epsilon$
\end_inset


\begin_inset Formula 
\[
\max_{t\in\{0,1,2,\dots,\mathcal{T}\}}\left|r_{t}-r_{t}^{\prime}\right|<\epsilon
\]

\end_inset

otherwise return to step 2 with 
\begin_inset Formula $\{r_{t}\}_{t=0}^{\mathcal{T}}=\{\nu r_{t}+(1-\nu)r_{t}^{\prime}\}_{t=0}^{\mathcal{T}}$
\end_inset


\end_layout

\begin_layout Standard

\series bold
Note: 
\series default
Typically the relaxation parameter is 
\begin_inset Formula $\nu=0.90$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "kirkby_transition_2017"
literal "true"

\end_inset


\end_layout

\begin_layout Subsection
Households - with aggregate shocks
\end_layout

\begin_layout Itemize

\series bold
Aggregate shocks: 
\series default
Assume 
\begin_inset Formula $Z_{t}$
\end_inset

 is a stochastic process
\end_layout

\begin_layout Itemize

\series bold
Root problem: 
\series default
There is no longer perfect foresight wrt.
 
\begin_inset Formula $r_{t}$
\end_inset

 and 
\begin_inset Formula $w_{t}$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
Extended problem:
\series default

\begin_inset Formula 
\begin{eqnarray*}
v(e_{t},a_{t-1},Z_{t},D_{t}) & = & \max_{c_{t}}\frac{c_{t}^{1-\sigma}}{1-\sigma}+\beta\mathbb{E}_{t}\left[v(e_{t+1},a_{t},Z_{t+1},D_{t+1})\right]\\
 & \text{s.t.}\\
a_{t}+c_{t} & = & (1+r_{t})a_{t-1}+w_{t}e_{t}\\
k_{t} & = & \int a^{\ast}(e_{t},a_{t-1},Z_{t},D_{t})dD_{t}\\
r_{t} & = & r(k_{t},Z_{t})\\
w_{t} & = & w(r_{t},Z_{t})\\
a_{t} & \geq & 0
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Ultimate problem:
\series default
 
\begin_inset Formula $D_{t}$
\end_inset

 is not easy to discretize...
\end_layout

\begin_layout Itemize

\series bold
Krusell-Smith idea: 
\series default
Approximate 
\begin_inset Formula $D_{t}$
\end_inset

 with some selected moments, e.g.
 just the mean
\end_layout

\begin_layout Itemize

\series bold
Approximate problem:
\series default

\begin_inset Formula 
\begin{eqnarray*}
v(e_{t},a_{t-1},Z_{t},k_{t}) & = & \max_{c_{t}}\frac{c_{t}^{1-\sigma}}{1-\sigma}+\beta\mathbb{E}_{t}\left[v(e_{t+1},a_{t},Z_{t+1},k_{t+1})\right]\\
 & \text{s.t.}\\
a_{t}+c_{t} & = & (1+r_{t})a_{t-1}+w_{t}e_{t}\\
r_{t} & = & r(k_{t},Z_{t})\\
w_{t} & = & w(r_{t},Z_{t})\\
k_{t+1} & = & \text{PLM}(k_{t},Z_{t},Z_{t+1})\\
a_{t} & \geq & 0
\end{eqnarray*}

\end_inset

where 
\begin_inset Formula $\text{PLM}(k_{t},Z_{t},Z_{t+1})$
\end_inset

 is the 
\series bold
perceived law of motion
\end_layout

\begin_layout Subsection
Definition: Dynamic equilibrium
\end_layout

\begin_layout Standard
An 
\series bold
(approximate) dynamic equilibrium 
\series default
is a 
\begin_inset Formula $\text{PLM}$
\end_inset

, policy functions 
\begin_inset Formula $a_{t}^{\ast}(\bullet)$
\end_inset

 and 
\begin_inset Formula $c_{t}^{\ast}(\bullet)$
\end_inset

, and paths of quantities 
\begin_inset Formula $K_{t}$
\end_inset

 and 
\begin_inset Formula $L_{t}$
\end_inset

, prices 
\begin_inset Formula $r_{t}$
\end_inset

 and 
\begin_inset Formula $w_{t}$
\end_inset

, distributions 
\begin_inset Formula $D_{t}$
\end_inset

 such that for all 
\begin_inset Formula $t$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $a_{t}^{\ast}(\bullet)$
\end_inset

 and 
\begin_inset Formula $c_{t}^{\ast}(\bullet)$
\end_inset

 solve the household problem given the 
\begin_inset Formula $\text{PLM}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $D_{t}$
\end_inset

 is implied by the household problem
\end_layout

\begin_layout Enumerate
Firms profit maximize 
\begin_inset Formula $r_{t}=r(K_{t-1}/L_{t},Z_{t})$
\end_inset

 and 
\begin_inset Formula $w_{t}=w(r_{t},Z_{t})$
\end_inset


\end_layout

\begin_layout Enumerate
The labor market clears, i.e.
 
\begin_inset Formula $L_{t}=\int e_{t}dD_{t}=1$
\end_inset


\end_layout

\begin_layout Enumerate
The capital market clears, i.e.
 
\begin_inset Formula $K_{t}=\int a_{t}^{\ast}(\bullet)dD_{t}$
\end_inset


\end_layout

\begin_layout Enumerate
The goods market clears, i.e.
 
\begin_inset Formula $Y_{t}=\int c_{t}^{\ast}(\bullet)dD_{t}+\delta K_{t-1}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\text{PLM}(k_{t},Z_{t},Z_{t+1})$
\end_inset

 does not imply systematic expectations errors
\end_layout

\begin_layout Standard

\series bold
Note: 
\series default
When 
\begin_inset Formula $Z_{t}=Z_{ss}\forall Z_{t}$
\end_inset

 the dynamic equilibrium does 
\emph on
not 
\emph default
converge to the stationary equilibrium unless the households know 
\begin_inset Formula $Z_{t}$
\end_inset

 is actually not stochastic.
\end_layout

\begin_layout Subsection
Find dynamic equilibrium
\end_layout

\begin_layout Enumerate
Guess on the 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\text{PLM}(k_{t},Z_{t},Z_{t+1})$
\end_inset


\end_layout

\begin_layout Enumerate
Solve the household problem
\end_layout

\begin_layout Enumerate
Simulate a path of 
\begin_inset Formula $Z_{t}$
\end_inset

 and 
\begin_inset Formula $D_{t}$
\end_inset

 and thus 
\begin_inset Formula $k_{t}$
\end_inset


\end_layout

\begin_layout Enumerate
Compare simulated behavior with the 
\begin_inset Formula $\text{PLM}(k_{t},Z_{t},Z_{t+1})$
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Stop if 
\begin_inset Quotes ald
\end_inset

good enough
\begin_inset Quotes ard
\end_inset

 
\begin_inset Newline newline
\end_inset

otherwise update 
\begin_inset Formula $\text{PLM}(k_{t},Z_{t},Z_{t+1})$
\end_inset

 and return to step 2
\end_layout

\end_deeper
\begin_layout Standard

\series bold
Terminology:
\end_layout

\begin_layout Enumerate
The Krusell-Smith method is a 
\series bold
global solution method
\end_layout

\begin_layout Enumerate
The newest
\series bold
 local
\series default
 
\series bold
solution methods 
\series default
rely on linearization of the aggregate dynamics, but solve for the full
 non-linear stationary equilibrium
\end_layout

\begin_layout Enumerate

\series bold
Older solution methods 
\series default
linearized both the 
\series bold
idiosyncratic 
\series default
and the 
\series bold
aggregate dynamics
\end_layout

\begin_layout Section
Sequence-Space Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Sequence-Space-Method"

\end_inset


\end_layout

\begin_layout Standard

\series bold
Main idea: 
\series default
We are interested in the dynamic equilibrium, but want to avoid solving
 the model with aggregate shocks.
\end_layout

\begin_layout Standard

\series bold
Starting point: 
\series default
Consider the model in 
\series bold
sequence-space, 
\series default
such that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
K_{t}^{s} & =\int a^{\ast}(e_{t},a_{t-1})dD_{t}\label{eq:Ks}\\
 & \equiv\mathcal{K}_{t}\{\{r_{s},w_{s}\}_{s\geq0},D_{0})\}\nonumber 
\end{align}

\end_inset

where the second line is just a re-formulation of the model in 
\series bold
sequence space
\series default
 conditional on the distribution in period 
\begin_inset Formula $0$
\end_inset

.
 Let 
\begin_inset Formula $\boldsymbol{K}=(K_{0},K_{1},\dots$
\end_inset

) and 
\begin_inset Formula $\boldsymbol{Z}=(Z_{0},Z_{1},\dots)$
\end_inset

.
 For given 
\begin_inset Formula $\boldsymbol{Z}$
\end_inset

 the model is now the solution to the following equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
H_{t}(\boldsymbol{K},\boldsymbol{Z},D_{0})\equiv\mathcal{K}_{t}(\{r(Z_{s},K_{s-1}),w(Z_{s},K_{s-1})\}_{s\geq0},D_{0})-K_{t}=0,\qquad t=0,1,\dots\label{eq:H}
\end{align}

\end_inset

Or in 
\series bold
time-stacked form
\series default

\begin_inset Formula 
\begin{equation}
\boldsymbol{H}(\boldsymbol{K},\boldsymbol{Z},D_{0})=\boldsymbol{0}\label{eq:Hvec}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization
\end_layout

\begin_layout Standard
Total differentiation implies
\begin_inset Formula 
\begin{align}
\boldsymbol{H}_{\boldsymbol{K}}\boldsymbol{H}_{\boldsymbol{Z}}d\boldsymbol{K}+\boldsymbol{H}_{\boldsymbol{Z}}d\boldsymbol{Z}=0 & \Leftrightarrow\nonumber \\
d\boldsymbol{K} & =-\boldsymbol{H}_{\boldsymbol{K}}^{-1}\boldsymbol{H}_{\boldsymbol{Z}}d\boldsymbol{Z}\label{eq:dk_dZ}
\end{align}

\end_inset

where
\begin_inset Formula 
\[
\boldsymbol{H}_{\boldsymbol{K}}=\left[\begin{array}{ccc}
\frac{\partial H_{0}}{\partial K_{0}} & \frac{\partial H_{0}}{\partial K_{1}} & \cdots\\
\frac{\partial H_{1}}{\partial K_{0}} & \ddots & \ddots\\
\vdots & \ddots & \ddots
\end{array}\right],\,\boldsymbol{H}_{\boldsymbol{Z}}=\left[\begin{array}{ccc}
\frac{\partial H_{0}}{\partial Z_{0}} & \frac{\partial H_{0}}{\partial Z_{1}} & \cdots\\
\frac{\partial H_{1}}{\partial Z_{0}} & \ddots & \ddots\\
\vdots & \ddots & \ddots
\end{array}\right]
\]

\end_inset

A central insight is that 
\begin_inset Formula $\mathcal{K}_{t}$
\end_inset

 
\series bold
only depends on the prices
\series default
 and not the aggregate quantities in themselves.
 Consequently, applying the chain rule, we have
\begin_inset Formula 
\begin{align}
\boldsymbol{H}_{\boldsymbol{K}} & =\mathcal{J}^{\mathcal{K},r}\mathcal{J}^{r,K}+\mathcal{J}^{\mathcal{K},w}\mathcal{J}^{w,K}-\boldsymbol{I}\label{eq:HJJK}\\
\boldsymbol{H}_{Z} & =\mathcal{J}^{\mathcal{K},r}\mathcal{J}^{r,Z}+\mathcal{J}^{\mathcal{K},w}\mathcal{J}^{w,Z}\label{eq:HJJI}
\end{align}

\end_inset

where generically
\begin_inset Formula 
\[
\mathcal{J}^{x,y}=\left[\begin{array}{ccc}
\frac{\partial x_{0}}{\partial y_{0}} & \frac{\partial x_{0}}{\partial y_{1}} & \cdots\\
\frac{\partial x_{1}}{\partial y_{0}} & \ddots & \ddots\\
\vdots & \ddots & \ddots
\end{array}\right]
\]

\end_inset

and specifically
\begin_inset Formula 
\[
\mathcal{J}^{\mathcal{K},r}=\left[\begin{array}{ccc}
\frac{\partial\mathcal{K}_{0}}{\partial r_{0}} & \frac{\partial\mathcal{K}_{0}}{\partial r_{1}} & \cdots\\
\frac{\partial\mathcal{K}_{1}}{\partial r_{0}} & \ddots & \ddots\\
\vdots & \ddots & \ddots
\end{array}\right],\mathcal{J}^{r,K}=\alpha(\alpha-1)Z_{t}K_{t}^{\alpha-2}\begin{bmatrix}0 & 0 & \cdots & 0\\
1 & 0 & \cdots & 0\\
\vdots & 1 & 0 & \vdots\\
0 & 0 & \ddots & 0\\
0 & 0 & \cdots & 1
\end{bmatrix},\mathcal{J}^{r,Z}=\alpha K_{t}^{\alpha-1}\boldsymbol{I}
\]

\end_inset

and
\begin_inset Formula 
\[
\mathcal{J}^{\mathcal{K},w}=\left[\begin{array}{ccc}
\frac{\partial\mathcal{K}_{0}}{\partial w_{0}} & \frac{\partial\mathcal{K}_{0}}{\partial w_{1}} & \cdots\\
\frac{\partial\mathcal{K}_{1}}{\partial w_{0}} & \ddots & \ddots\\
\vdots & \ddots & \ddots
\end{array}\right],\mathcal{J}^{w,K}=(1-\alpha)\alpha Z_{t}K_{t}^{\alpha-1}\begin{bmatrix}0 & 0 & \cdots & 0\\
1 & 0 & \cdots & 0\\
\vdots & 1 & 0 & \vdots\\
0 & 0 & \ddots & 0\\
0 & 0 & \cdots & 1
\end{bmatrix},\mathcal{J}^{w,Z}=(1-\alpha)K_{t}^{\alpha}\boldsymbol{I}
\]

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\forall t\neq s-1:\frac{\partial r_{t}}{\partial K_{s}}=\frac{\partial w_{t}}{\partial K_{s}}=0$
\end_inset

 and 
\begin_inset Formula $\forall s\neq t:\frac{\partial r_{t}}{\partial Z_{s}}=\frac{\partial w_{s}}{\partial Z_{s}}=0$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Truncation:
\series default
 In practice the matrices are truncated, such that they are 
\begin_inset Formula $T\times T$
\end_inset

.
\end_layout

\begin_layout Enumerate

\series bold
Along a row:
\series default
 The effect on a variable in a given period of a shock in an arbitrary period.
\end_layout

\begin_layout Enumerate

\series bold
Along a column: 
\series default
The effect of a shock in a given period on a variable in an arbitrary period.
\end_layout

\begin_layout Subsection
Intermezzo: No uncertainty
\end_layout

\begin_layout Standard
In the case where there is no income risk, the household problem reduces
 to a 
\series bold
permanent income hypothesis model 
\series default
with the solution
\begin_inset Formula 
\begin{align}
C_{0}(\{r_{s},w_{s}\}_{s\geq0}) & =\frac{(1+r_{0})a_{-1}+\sum_{t=0}^{\infty}\frac{1}{\mathcal{R}_{t}}w_{t}}{\sum_{t=0}^{\infty}\beta^{t/\rho}\mathcal{R}_{t}^{\frac{1-\rho}{\rho}}}\label{eq:C_no_risk}\\
C_{t}(\{r_{s},w_{s}\}_{s\geq0}) & =\beta^{1/\rho}(1+r_{t})^{1/\rho}C_{t-1}(\{r_{s},w_{s}\}_{s\geq0})\nonumber \\
 & =\beta^{t/\rho}\mathcal{R}_{t}^{1/\rho}C_{0}(\{r_{s},w_{s}\}_{s\geq0})\nonumber 
\end{align}

\end_inset

where the 
\series bold
compound interest rate factor
\series default
 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{R}_{t}=\begin{cases}
1 & \text{if }t=0,\\
(1+r_{t})\mathcal{R}_{t-1} & \text{else}
\end{cases}\label{eq:R_compound}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The partial derivatives of a price change at time 
\emph on

\begin_inset Formula $s$
\end_inset


\emph default
 can all be written in terms of the effect on 
\series bold
period 0 consumption
\series default

\begin_inset Formula 
\begin{align}
\frac{\partial C_{t}}{\partial w_{s}} & =\beta^{1/\rho}(1+r_{t})^{1/\rho}\frac{\partial C_{t-1}}{\partial w_{s}}=\beta^{t/\rho}\mathcal{R}_{t}^{1/\rho}\frac{\partial C_{0}}{\partial w_{s}},\label{eq:dC_dw}\\
\frac{\partial C_{t}}{\partial r_{s}} & =\beta^{t/\rho}\mathcal{R}_{t}^{1/\rho}\frac{\partial C_{0}}{\partial r_{s}}+\begin{cases}
0 & \text{if }t<s,\\
\beta^{t/\rho}(\mathcal{R}_{t})^{1/\rho}\frac{C_{0}}{\rho(1+r_{s})} & \text{\text{else}}.
\end{cases}\label{eq:dC_dr}
\end{align}

\end_inset

Capital accumulation follows the recursion
\begin_inset Formula 
\begin{align*}
\mathcal{K}_{0} & =(1+r_{0})K_{-1}+w_{0}-C_{0}(\{r_{s},w_{s}\}_{s\geq0})\\
\mathcal{K}_{1} & =(1+r_{1})\mathcal{K}_{0}+w_{1}-C_{1}(\{r_{s},w_{s}\}_{s\geq0})\\
\vdots\\
\mathcal{K}_{t} & =(1+r_{t})\mathcal{K}_{t-1}+w_{t}-C_{t}(\{r_{s},w_{s}\}_{s\geq0})\\
\vdots
\end{align*}

\end_inset

The Jacobian 
\begin_inset Formula $\mathcal{J}^{\mathcal{K},r}$
\end_inset

 can now be constructed from the recursion
\begin_inset Formula 
\begin{align*}
\frac{\partial\mathcal{K}_{0}}{\partial r_{s}} & =1\{s=0\}K_{-1}+\frac{\partial C_{0}}{\partial r_{s}}\\
\frac{\partial\mathcal{K}_{1}}{\partial r_{s}} & =1\{s=1\}\mathcal{K}_{0}+(1+r_{1})\frac{\partial\mathcal{K}_{0}}{\partial r_{s}}+\frac{\partial C_{1}}{\partial r_{s}}\\
\vdots\\
\frac{\partial\mathcal{K}_{t}}{\partial r_{s}} & =1\{s=t\}\mathcal{K}_{s}+(1+r_{t})\frac{\partial\mathcal{K}_{t-1}}{\partial r_{s}}+\frac{\partial C_{t}}{\partial r_{s}}
\end{align*}

\end_inset

and similar for
\begin_inset Formula $\mathcal{J}^{\mathcal{K},w}$
\end_inset

 
\begin_inset Formula 
\begin{align*}
\frac{\partial\mathcal{K}_{0}}{\partial r_{s}} & =\frac{\partial C_{0}}{\partial w_{s}}\\
\frac{\partial\mathcal{K}_{1}}{\partial r_{s}} & =(1+r_{1})\frac{\partial\mathcal{K}_{0}}{\partial w_{s}}+\frac{\partial C_{1}}{\partial w_{s}}\\
\vdots\\
\frac{\partial\mathcal{K}_{t}}{\partial r_{s}} & =(1+r_{t})\frac{\partial\mathcal{K}_{t-1}}{\partial w_{s}}+\frac{\partial C_{t}}{\partial w_{s}}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Transition path after MIT shock
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transition-path-after"

\end_inset


\end_layout

\begin_layout Enumerate
Assume we 
\series bold
start in the stationary equilibrium
\end_layout

\begin_layout Enumerate

\series bold
MIT-shock: 
\series default
Known path of future 
\begin_inset Formula $\boldsymbol{Z}$
\end_inset

, i.e.
 in terms of changes from steady state 
\begin_inset Formula $d\boldsymbol{Z}=\boldsymbol{Z}-Z_{ss}$
\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Question:
\series default
 What happens to aggregate capital?
\end_layout

\begin_layout Enumerate

\series bold
Answer:
\series default
 To a first order using equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dk_dZ"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we have
\begin_inset Formula 
\[
\boldsymbol{G}^{K,Z}\equiv\frac{d\boldsymbol{K}}{d\boldsymbol{Z}}=-\boldsymbol{H}_{\boldsymbol{K}}^{-1}\boldsymbol{H}_{\boldsymbol{Z}}
\]

\end_inset

where all derivatives are 
\series bold
evaluated at the stationary equilibrium
\series default
.
\end_layout

\begin_deeper
\begin_layout Standard
Additional responses are easily calculated:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{G}^{r,Z}\equiv\frac{d\boldsymbol{r}}{d\boldsymbol{Z}}=\mathcal{J}^{r,Z}+\mathcal{J}^{r,K}\frac{d\boldsymbol{K}}{d\boldsymbol{Z}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{G}^{w,Z}\equiv\frac{d\boldsymbol{w}}{d\boldsymbol{Z}}=\mathcal{J}^{w,Z}+\mathcal{J}^{w,K}\frac{d\boldsymbol{K}}{d\boldsymbol{Z}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{G}^{C,Z}\equiv\frac{d\boldsymbol{C}}{d\boldsymbol{Z}}=\mathcal{J}^{C,r}\frac{d\boldsymbol{r}}{d\boldsymbol{Z}}+\mathcal{J}^{C,w}\frac{d\boldsymbol{w}}{d\boldsymbol{Z}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{G}^{Y,Z}\equiv\frac{d\boldsymbol{Y}}{d\boldsymbol{Z}}=\mathcal{J}^{Y,Z}+\mathcal{J}^{Y,K}\frac{d\boldsymbol{K}}{d\boldsymbol{Z}}
\]

\end_inset


\series bold
Transition path
\series default
 for variable 
\begin_inset Formula $o$
\end_inset

 is then 
\begin_inset Formula $d\boldsymbol{X}^{o}=\boldsymbol{G}^{o,Z}d\boldsymbol{Z}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
Impulse-responses and and covariances with aggregate risk
\end_layout

\begin_layout Standard
Let us now return to the 
\series bold
model with aggregate risk
\series default
 where 
\begin_inset Formula $\tilde{Z}_{t}$
\end_inset

 is a stochastic variable as indicated by the tilde.
\end_layout

\begin_layout Enumerate
In the limit where the shock variance disappears the dynamic equilibrium
 path converge to the stationary equilibrium.
\end_layout

\begin_layout Enumerate
In the limit where the shock variance disappears the transition path to
 the MIT shock around the stationary equilibrium is the same as the impulse-resp
onse in the dynamic equilibrium.
\end_layout

\begin_layout Standard

\series bold
Remark:
\series default
 This is formally proved in 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_using_2019"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Think as follows:
\end_layout

\begin_layout Enumerate

\series bold
MA representation: 
\series default

\begin_inset Newline newline
\end_inset

Assume that the TFP process has a 
\begin_inset Formula $MA(\infty)$
\end_inset

 representation given by
\begin_inset Formula 
\[
d\tilde{Z}_{t}=\sum_{s=0}^{\infty}m_{s}^{Z}\epsilon_{t-s},
\]

\end_inset

where 
\begin_inset Formula $d\tilde{Z}_{t}\equiv\tilde{Z}_{t}-Z_{ss}$
\end_inset

 is deviations from stationary equilibrium, 
\begin_inset Formula $\epsilon_{t}$
\end_inset

's are mutually iid 
\series bold
standard normally
\series default
 distributed innovations and 
\begin_inset Formula $m_{s}^{Z}$
\end_inset

 is the 
\begin_inset Formula $MA$
\end_inset

 coefficients.
\end_layout

\begin_deeper
\begin_layout Standard
After a 
\series bold
first order linearization
\series default
 any 
\emph on
stochastic 
\emph default
output variable 
\begin_inset Formula $\tilde{X_{t}^{o}}$
\end_inset

 also have an 
\begin_inset Formula $MA(\infty)$
\end_inset

 representation
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
d\tilde{X_{t}^{o}}=\sum_{s=0}^{\infty}m_{s}^{o,Z}\epsilon_{t-s}^{Z}.
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Equivalence result: 
\series default
Think of the following two experiments.
\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
In the stochastic model: 
\series default
Assume that there is a shock in period 
\begin_inset Formula $t$
\end_inset

, and no shocks in any other past or future period.
 This implies
\begin_inset Formula 
\begin{align*}
\mathbb{E}_{t}[d\tilde{X}_{t+s}|\epsilon_{t}=1,\epsilon_{k}=0\forall k\neq t] & =m_{s}^{o,Z}\\
\mathbb{E}_{t}[d\tilde{Z}_{t+s}|\epsilon_{t}=1,\epsilon_{k}=0\forall k\neq t] & =m_{s}^{Z}
\end{align*}

\end_inset

and likewise
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbb{E}_{t}[d\tilde{\boldsymbol{X}}_{t}|\epsilon_{t}=1,\epsilon_{k}=0\forall k\neq t] & =\boldsymbol{m}^{o,Z}=(m_{0}^{o,Z},m_{1}^{o,Z},\dots)^{T}\\
\mathbb{E}_{t}[d\tilde{\boldsymbol{Z}}_{t}|\epsilon_{t}=1,\epsilon_{k}=0\forall k\neq t] & =\boldsymbol{m}^{Z}=(m_{0}^{Z},m_{1}^{Z},\dots)^{T}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
In the deterministic model: 
\series default
Think of an MIT-shock where 
\begin_inset Formula $d\boldsymbol{Z}=\boldsymbol{m}^{Z}$
\end_inset

.
 The path of the output variable then is
\begin_inset Formula 
\[
d\boldsymbol{X}^{o}=\boldsymbol{G}^{o,Z}d\boldsymbol{Z}=\boldsymbol{G}^{o,Z}\boldsymbol{m}^{Z}
\]

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Certainty equivalence:
\series default
 Because of certainty equivalence these two experiments yield the same result
 and therefore
\begin_inset Formula 
\begin{align*}
d\boldsymbol{X}^{o} & =\mathbb{E}_{t}[d\tilde{\boldsymbol{X}}_{t}|\epsilon_{t}=1,\epsilon_{k}=0\forall k\neq t]\Leftrightarrow\\
\boldsymbol{m}^{o,Z} & =\boldsymbol{G}^{o,Z}\boldsymbol{m}^{Z}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The 
\series bold
covariance
\series default
 between any two output variables is given by
\begin_inset Formula 
\begin{align*}
\text{Cov\ensuremath{(d\tilde{X_{t}^{o}},d\tilde{X}_{t+k}^{o})=}} & \mathbb{E}_{t}\text{\ensuremath{\left[d\tilde{X_{t}^{o}}\left(d\tilde{X}_{t+k}^{o}\right)^{T}\right]}}\\
= & \mathbb{E}_{t}\text{\ensuremath{\left[\left(\boldsymbol{m}^{o,Z}\right)^{T}\boldsymbol{\epsilon}_{t}^{Z}\left(\boldsymbol{\epsilon}_{t+k}^{Z}\right)^{T}\boldsymbol{m}^{o,Z}\right]}}\\
= & \sum_{s=0}^{\infty}m_{s}^{o,Z}m_{s+k}^{o,Z}
\end{align*}

\end_inset

where we use that 
\begin_inset Formula 
\begin{align*}
\mathbb{E}_{t}\left[\boldsymbol{\epsilon}_{t}^{Z}\left(\boldsymbol{\epsilon}_{t+k}^{Z}\right)^{T}\right] & =\mathbb{E}_{t}\left[\begin{array}{ccccccc}
\epsilon_{t}^{Z}\epsilon_{t+k}^{Z} & \epsilon_{t}^{Z}\epsilon_{t+k-1}^{Z} & \cdots & \epsilon_{t}^{Z}\epsilon_{t}^{Z} & \cdots & \cdots & \cdots\\
\epsilon_{t-1}^{Z}\epsilon_{t+k}^{Z} & \epsilon_{t-1}^{Z}\epsilon_{t+k-1}^{Z} & \cdots & \epsilon_{t-1}^{Z}\epsilon_{t}^{Z} & \epsilon_{t}^{Z}\epsilon_{t-1}^{Z} & \cdots & \cdots\\
\epsilon_{t-2}^{Z}\epsilon_{t+k}^{Z} & \epsilon_{t-2}^{Z}\epsilon_{t+k-1}^{Z} & \cdots & \epsilon_{t-2}^{Z}\epsilon_{t}^{Z} & \epsilon_{t}^{Z}\epsilon_{t-1}^{Z} & \epsilon_{t-2}^{Z}\epsilon_{t-2}^{Z} & \cdots\\
\vdots & \vdots & \vdots & \vdots & \vdots & \ddots & \ddots
\end{array}\right]\\
 & =\left[\begin{array}{ccccccc}
0 & 0 & \cdots & 1 & \cdots & \cdots & \cdots\\
0 & 0 & \cdots & 0 & 1 & \cdots & \cdots\\
0 & 0 & \cdots & 0 & 0 & 1 & \cdots\\
\vdots & \vdots & \vdots & \vdots & \vdots & \ddots & \ddots
\end{array}\right].
\end{align*}

\end_inset


\series bold
Truncation: 
\series default
Since the Jacobians are only computed for some truncated horizon 
\begin_inset Formula $T$
\end_inset

, we have that 
\begin_inset Formula 
\[
\mbox{Cov}(d\tilde{X}_{t},d\tilde{X}_{t+k})=\sum_{s=0}^{T-k}m_{s}^{o,Z}m_{s+k}^{o,Z}
\]

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Example: 
\series default
Let TFP follow the 
\begin_inset Formula $AR(1)$
\end_inset

 process
\begin_inset Formula 
\begin{align*}
\tilde{Z}_{t} & =1-\rho+\rho\tilde{Z}_{t-1}+\sigma\epsilon_{t}.\\
\Rightarrow & d\tilde{Z}_{t}=\sigma\sum_{s=0}^{\infty}\rho^{s}\epsilon_{t-s},
\end{align*}

\end_inset

with 
\begin_inset Formula $m_{s}^{Z}=\sigma\rho^{s}.$
\end_inset

 Given 
\begin_inset Formula $\boldsymbol{G}^{o,Z}$
\end_inset

, we have that
\begin_inset Formula 
\[
\mbox{Cov}(d\tilde{X_{t}^{o}},d\tilde{X_{t+k}^{o}})=\sigma^{2}\sum_{s=0}^{T-k}\rho^{2s+k}\boldsymbol{G}_{t,s}^{o,Z}\boldsymbol{G}_{t+k,s}^{o,Z}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
.
\]

\end_inset


\end_layout

\begin_layout Subsection
Computational efficiency
\end_layout

\begin_layout Standard
Much of 
\begin_inset CommandInset citation
LatexCommand citet
key "auclert_using_2019"
literal "false"

\end_inset

 is about 
\series bold
computational efficiency
\series default
.
 How to:
\end_layout

\begin_layout Enumerate
Compute the jacobians of the heterogenous agent block efficiently.
\end_layout

\begin_layout Enumerate
Multiply the (sparse) jacobians efficiently.
\end_layout

\begin_layout Enumerate
Compute the covariance matrix efficiently.
\end_layout

\begin_layout Standard
Additionally, the paper shows:
\end_layout

\begin_layout Enumerate
How to check for determinancy.
\end_layout

\begin_layout Enumerate
How to use the computed jacobians to speed-up the solution of the fully
 non-linear transition path.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "2020_SEQJAC"
options "apa"

\end_inset


\end_layout

\end_body
\end_document
